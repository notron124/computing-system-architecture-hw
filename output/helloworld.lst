     1                                  global _start
     2                                  
     3                                  section .data
     4 00000000 2E2E2F6F7574707574-         filename db "../output/output.txt", 0
     4 00000009 2F6F75747075742E74-
     4 00000012 787400             
     5                                      filename_length equ $ - filename
     6 00000015 48656C6C6F20776F72-         message db "Hello world!", 10
     6 0000001E 6C64210A           
     7                                      message_length  equ $ - message
     8                                  
     9                                  section .text
    10                                  _start:
    11                                      ; Открыть или создать файл
    12 00000000 B855000000                  mov rax, 85                 ; 85 - системный вызов sys_creat
    13 00000005 48BF-                       mov rdi, filename
    13 00000007 [0000000000000000] 
    14 0000000F BEA4010000                  mov rsi, 0o644              ; 6 - rw для роли owner (r = 4, w = 2, x = 1), 4 - read для остальных
    15 00000014 0F05                        syscall
    16                                      
    17 00000016 4885C0                      test rax, rax               ; eax and eax, выставляет SF флаг, если eax отрицательный
    18 00000019 783C                        js handle_error             ; jump if sign, провека на флаг знака
    19                                  
    20 0000001B 4889C3                      mov rbx, rax                ; Системный вызов возвращает
    21                                                                  ; дескриптор файла, сохраняем его в регистр rbx                                
    22                                      
    23                                      ; Запись в файл
    24 0000001E B801000000                  mov rax, 1
    25 00000023 4889DF                      mov rdi, rbx
    26 00000026 48BE-                       mov rsi, message
    26 00000028 [1500000000000000] 
    27 00000030 BA0D000000                  mov rdx, message_length
    28 00000035 0F05                        syscall
    29                                  
    30 00000037 4885C0                      test rax, rax               
    31 0000003A 781B                        js handle_error
    32                                  
    33                                      ; Закрыть файл
    34 0000003C B803000000                  mov rax, 3                  ; 3 - системный вызов sys_close
    35 00000041 4889DF                      mov rdi, rbx                ; передаем в него файл дескриптор
    36 00000044 0F05                        syscall
    37                                  
    38 00000046 4885C0                      test rax, rax               
    39 00000049 780C                        js handle_error             ; А как проверять функции, которые возвращают
    40                                                                  ; отрицательное число? Делать функцию, которая
    41                                                                  ; будет возвращать явную константу на ошибку,
    42                                                                  ; или есть способ лучше?
    43                                  
    44                                      ; Выход
    45 0000004B B83C000000                  mov rax, 60
    46 00000050 BF00000000                  mov rdi, 0
    47 00000055 0F05                        syscall
    48                                  
    49                                  ; На C я бы сделал текстовый вывод под каждую ошибку, если успею, то сделаю и
    50                                  ; тут. (Прим. "Failed to open/create *file_name*, errno: %d")
    51                                  handle_error:
    52 00000057 48F7D8                      neg rax
    53 0000005A 4889C7                      mov rdi, rax
    54 0000005D B83C000000                  mov rax, 60
    55 00000062 0F05                        syscall
